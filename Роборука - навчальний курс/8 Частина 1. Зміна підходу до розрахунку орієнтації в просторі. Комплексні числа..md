
### План уроку
---
- [ ] ?

### Матеріали
---
- [ ] ?

### Результат уроку
---
Результатом даного уроку має бути:

?


В чому проблема використання кутів Ейлера? - так звані замки Ейлера. 
Якщо простіше - ми можемо це зрозуміти переглянувши наступні анімації:

на першій анімації видно, що плече нашої руки може обертатись як мінімум в трьох степенях вільності:
[анімація з опущеною рукою]

якщо ми змінимо положення нашої руки, то ми втратимо одну степінь вільності, і замість тьох ми тепер можемо зробити тільки два рухи. Це приклад замка Ейлера в природі. 
 [анімація з піднятою рукою в бік]

Звісно цих проблем людської анатомії ми не можемо уникнути, але при розрахунку орієнтації ми можемо отримати такі замки по інших осях навіть не підозрюючи того. Т

Фізики називають цей процес складанням рамок. 
![[l8_gimbal_lock.gif]]
Як видно з попередньої анімації, час від часу карданний підвіс із трьома осями обертання знаходиться в ситуації, коли розміщення всіх трьох рамок збігаються. В той момент рухи дуже обмежені та можуть призвести до подальших помилок при розрахунках. 

Тому для відображення і вираховування нашої позиції в просторі прийнято уникати такого інструменту як кути Ейлера. Натомість найчастіше знаходять своє застосування матриці обертання, або як їх ще називають "матриці напрямних косинусів" та кватерніони. 

Якщо ви не знайомі з цими поняттями, то зараз мабуть здалось, що це надзвичайно складні речі які не так просто зрозуміти, бо навіть в коледжах чи університетах їх не завжди вивчають. Підтвердити чи спростувати ваші думки я не можу, але спробую передати суть якнайпростіше. 

В межах даного курсу ми розглянемо тільки кватерніони, так як операції з ними простіші, їх менше і вони за допомогою чотирьох чисел відображають нашу орієнтацію в просторі уникаючи проблеми кутів Ейлера. 

Як це працює в порівнянні з кутами Ейлера: 
Для обертання обʼєкта в просторі за допомогою кутів Ейлера нам треба здійснити три дії: обертання навколо кожної осі окремо. 
![[l8_euler_rotation.gif]]

Якщо відкинути всі нюасни і пояснювати дуже просто, кватерніон має інший підхід. Там обертання відбувається одразу на потрібний кут навколо одного вектора:
![[l8_q_rotation.gif]]

Здійснюючи менше рухів, виконуючи менше операцій ми добиваємось того ж результату. 

Ви вже напевне здогадались від самої назви та від опису вище, що кватерніон - вектор, що складається не зі звичних для нас трьох координат, а з чотирьох. Один із них - кут. 

`vector_angle = \[angle, x, y, z\]`

Здавалось би все просто і тут зовсім нічого складного. Але, якщо розглядати дану задачу з таким підходом, то виникає питання, а як знаходити нову орієнтацію? Які математичні операції дозволять знайти нову позицію в просторі використовуючи кутову швидкість? Цим питанням математики задавались давно. 
Одним із них був Вільям Гамільтон. У 1848 році він довів, що 4 цифр може бути достатньо для повного відображення орієнтації обʼєкта уникаючи проблеми замикання рамок. 

Назвав він це кватерніонами та представив наступним чином:

1. Кватерніон таки складається з чотирьох компонентів
2. Перший компонент кватерніона - не просто кут обертання навколо вектора, а косинус половини цього кута:
`w = cos(angle / 2)`
3. Наступні три компоненти - не просто вектор, навколо якого здійснюється обертання, а 
`v = sin(angle / 2) \* \[x, y, z\] = \[sin(angle / 2) \* x, sin(angle / 2) \* y, sin(angle / 2) \* z,\]`
