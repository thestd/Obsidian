---
profileName: std::learn
postId: "69"
postType: post
categories:
  - 3
---
### План уроку
---
-  Підключення IMU до ESP32
-  Прошивання ESP32. Викладення основ роботи з IMU
-  Дані, виміряні IMU, та одиниці їх вимірювання

### Матеріали
---
-  ESP32 - 10 шт
-  IMU MPU6050 - 10 шт
-  Провідники 4-х кольорів, 26AWG, по 10 м.
-  Паяльники
-  Припій. Флюс/каніфоль

### Результат уроку
---
Результатом даного уроку має бути:

ESP32 із MPU6050, що вимірюють прискорення та кутову швидкість, і розраховують орієнтацію в просторі методом інтегрування Ейлера.

---

# Урок

### Підключення IMU до ESP32

![[l1_1.png]]
![[l1_2.png]]
Для підключення гіроакселерометра до плати розробника ми будемо використовувати I2C шину:

|**Контакт ни  ESP32**|**Контакт на MPU6050**|
|---|---|
|GPIO 22 (SCL)|SCL|
|GPIO 21 (SDA)|SDA|
|3V3|VCC|
|GND|GND|

### Прошивання ESP32. Викладення основ роботи з IMU

1. Для початку роботи з ESP32 створюємо проєкт в PlatformIO (`ESP32 Devkit V1`)
    
2. Встановлюємо додаткову бібліотеку `Adafruit MPU6050`
    
3. Вставляємо наступний код в `main.cpp`

```cpp
#include <Arduino.h>
#include <Adafruit_MPU6050.h>
#include <Adafruit_Sensor.h>

// Налаштування
#define SERIAL_SPEED     115200  // Швидкість послідовного порту
#define SENDING_INTERVAL 10      // Інтервал між надсиланнями даних в послідовний порт


// Об'єкти класів та змінні
Adafruit_MPU6050 mpu;
sensors_event_t a, g, temp;
uint32_t lastSendTime = 0;


void setup()
{
    // Ініціалізація послідовного порту
    Serial.begin(SERIAL_SPEED);

    // Ініціалізація гіроакселерометра
    if (!mpu.begin())
    {   
        // У випадку помилки програма залишиться у вічному циклі і не пройде далі
        Serial.println("Failed to find MPU6050 chip");
        while (1)
        {
            delay(10);
        }
    }

    mpu.setAccelerometerRange(MPU6050_RANGE_16_G);
    mpu.setGyroRange(MPU6050_RANGE_2000_DEG);
    mpu.setFilterBandwidth(MPU6050_BAND_260_HZ);
    delay(100);
}


void loop()
{
    // Перевіряємо, чи пройшла потрібна кількість часу перед надсиланням
    if((millis() - lastSendTime) >= SENDING_INTERVAL) 
    {
        // Отримуємо останні дані від гіроакселерометра
        mpu.getEvent(&a, &g, &temp);

        // Надсилаємо дані в послідовний порт
        Serial.print(a.acceleration.x); 
        Serial.print(",");
        Serial.print(a.acceleration.y);
        Serial.print(",");
        Serial.print(a.acceleration.z);
        Serial.print(",");
        Serial.print(g.gyro.x);
        Serial.print(",");
        Serial.print(g.gyro.y);
        Serial.print(",");
        Serial.print(g.gyro.z);
        Serial.println();

        // Фіксуємо час, коли відбулось надсилання
        lastSendTime = millis();
    }
}
```
    
4. Додаємо в файл `platformio.ini` рядок
    
```python
monitor_speed = 115200
```

5. Прошиваємо ESP32 та перевіряємо, чи приходять дані через послідовний порт


### Дані, виміряні IMU, та одиниці їх вимірювання
... 
**TODO: вставити приклад виміряних даних та розписати їх значення і одиниці вимірювання**




### Додаткові посилання
---
[Гіроскопічний ефект](https://www.youtube.com/watch?v=9J8hQolP6uk)

## Відеоуроки та записи уроку
---
[Урок 1- Гіроскоп та акселерометр](https://youtu.be/gMv16WGtVMc)